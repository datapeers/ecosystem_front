<div class="w-full h-max-router overflow-auto">
    <div class="flex flex-column xl:flex-row gap-4 justify-content-between">
        <div class="flex flex-column px-1 sm:px-4 md:px-8" style="flex: 1">
            <h2>Comunidades</h2>
            <div style="height: 1.5rem"></div>
            <div class="flex flex-row align-items-center gap-2">
                <i-tabler class="text-center cursor-pointer" (click)="launchTour()" name="bulb" style="color:#18E4E6; height:2rem; width:2rem;"></i-tabler>
                <p class="th2"> {{user?.isAdmin ? 'Esta es tu área de control para las Comunidades. Organiza y personaliza la visualización de los campos disponibles para cada comunidad, asegurándote de que la información clave esté a la vista. Configura las preferencias y restricciones según las necesidades de tu comunidad. ¡Haz clic en configuración para ajustarla y garantizar una experiencia óptima para tus miembros' : 'Aquí encontrarás una lista de grupos comprometidos y dispuestos a ayudar. Si necesitas asistencia, orientación o simplemente quieres ser parte de una comunidad activa, ¡no dudes en ponerte en contacto con alguna de ellas! Haz clic en una comunidad para conocer más y conectarte con sus miembros.'}}
                </p>
            </div>
        </div>
        <div class="flex flex-none flex-column sm:flex-row align-items-end gap-3 px-6 mt2 ">
            <!-- <div class="flex flex-column gap-2">
                <label>Ver por:</label>
                <div class="flex">
                    
                </div>
            </div>
            <div class="flex flex-column gap-2">
                <label>Ordenar por:</label>
                <p-dropdown optionLabel="name"></p-dropdown>
            </div>
            <div class="w-2"></div>
            <p-button label="+ Ticket"></p-button> -->
        </div>
    </div>
    <p-divider></p-divider>
    <div class="w-full px-4 flex flex-column gap-3" id="comunityTable" style="flex: 1">
        <div class="flex flex-wrap justify-content-end align-items-center">
            <input placeholder="Buscar" type="text" pInputText [(ngModel)]="currentFilterFieldValue" (input)="filterResults()" [pTooltip]="'Buscar'" tooltipPosition="left">
        </div>
        <!-- <app-dynamic-table [context]="tableContext" [options]="optionsTable" [loading]="loading" [title]="tableTitle" (action)="actionFromTable($event)" [allowFullscreen]="false" (onRowClick)="contact($event)">
        </app-dynamic-table> -->
        <div *ngFor="let community of communities_show" class="flex flex-row align-items-center w-full p-2 border-round shadow-2">
            <ng-container *ngIf="community.thumbnail; else noPic">
                <img [src]='community.thumbnail' alt="" class="border-round" style="height: 225px; width: 330px; object-fit: contain;">
            </ng-container>
            <ng-template #noPic>
                <img src='/assets/no-image-icon.png' alt="" class="border-round" style="height: 225px; width: 330px; object-fit: contain;">
            </ng-template>
            <div class="flex flex-column align-items-center justify-content-start w-full h-full">
                <span class="w-full text-2xl py-1 font-semibold" style="word-break: break-all;">{{community.item.nombre}}</span>
                <div class="w-full flex flex-row justify-content-between">
                    <div class="w-full flex flex-column">
                        <div class="flex flex-column ">
                            <span class="text-base my-1" style="max-width:max-content">
                                {{community.item.descripcion}}
                            </span>
                            <span><strong class="text-gray-600 ">{{community.lastPhaseName}} </strong>{{community.lastPhaseNumb}}</span>
                        </div>
                        <div class="flex align-items-center w-full my-1">
                            <span class="text-gray-600 font-semibold">
                                Sector:
                            </span>
                            <span class="text-base ml-2" style="max-width:max-content">
                                {{community.item.sector}}
                            </span>
                        </div>
                        <div class="flex flex-none flex-column align-items-center justify-content-start w-full">
                            <div class="flex align-items-center w-full my-1">
                                <span class="text-gray-600 font-semibold">
                                    Founder:
                                </span>
                                <span class="text-base ml-2" style="max-width:max-content">
                                    {{community.entrepreneurs[0].item.nombre}}
                                </span>
                            </div>
                            <div class="flex align-items-center w-full my-1">
                                <i class="pi pi-phone text-gray-600 font-semibold"></i>
                                <span class="text-base ml-2" style="max-width:max-content">
                                    {{community.entrepreneurs[0].item.telefono}}
                                </span>
                            </div>

                        </div>
                    </div>
                    <div class="flex align-items-end justify-content-center p-2">
                        <div class="flex flex-row justify-content-end align-items-end">
                            <div class="flex flex-row">
                                <p-button class="mx-1" type="button" icon="pi pi-inbox" label="" pTooltip="Contactar" tooltipPosition="top" (onClick)="contact(community)">
                                </p-button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>

<p-dialog appendTo="body" header="" [(visible)]="contactTo" [style]="{ width: '55vw' }" [draggable]="false" [resizable]="false" [modal]="true" maskStyleClass="dialog-app" [breakpoints]="{'960px': '85vw', '640px': '100vw'}">
    <div class="w-full flex flex-row gap-3" *ngIf="contactTo">
        <i-tabler name="heart-handshake" class="icon-dialog"></i-tabler>
        <div class="content-resource w-full flex flex-column justify-content-between pb-2 pr-4">
            <h3 class="overflow-hidden white-space-nowrap text-overflow-ellipsis" [style.color]="'black'" [pTooltip]="contactTo.item.nombre" style="width: 600px;">Contactar a {{contactTo.item.nombre}}</h3>
            <span></span>
        </div>
    </div>
    <p-divider></p-divider>
    <div class="flex flex-column w-full h-full px-3 justify-content-center align-items-center" *ngIf="contactForm">
        <form [formGroup]="contactForm" class="w-full formgrid grid">
            <div class="field app-input-field col-6">
                <label for="titleTicket">Asunto</label>
                <input id="titleTicket" pInputText type="text" class="appearance-none outline-none w-full" formControlName="subject" required>
            </div>
            <div class="field app-input-field col-6">
                <label for="categoryTicket">Quien escribe</label>
                <input id="titleTicket" pInputText type="text" class="appearance-none outline-none w-full" formControlName="from" required>
            </div>
            <span class="field app-input-field col-12">
                <label for="msgTicket">Mensaje</label>
                <textarea inputId="msgTicket" style="width: 100%;" rows="8" formControlName="body" pInputTextarea></textarea>
            </span>
        </form>
        <p-button type="submit" label="Enviar" (onClick)="sendContact()" [disabled]="contactForm.invalid" [loading]="sending" styleClass="p-button-lg border-round-2xl my-2 p-3"></p-button>
    </div>
</p-dialog>